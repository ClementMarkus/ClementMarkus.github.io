<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Calculateur d'impÃ´t</title>
  <link rel="stylesheet" href="css/style.css" />
  
</head>
<body>
  <div class="header">
    <strong>Calculateur d'impÃ´t</strong>
  </div>
  <div class="button-container">
    <button class="button" onclick="location.href='outils.html';">â¬… Retour aux outils</button>
  </div>


  <div class="flex-container">

    <!-- Calculatrice -->
    <div class="card flex-item">
      <label class="label">Nom du client</label>
      <input id="nom" type="text" placeholder="Ex: Jean Tremblay">

      <label class="label">Revenu imposable ($)</label>
      <input id="revenu" type="number" value="50000">

      <button onclick="calculerImpots()" class="button">Calculer</button>
      <button onclick="telechargerPDF()" class="button">ðŸ“„ TÃ©lÃ©charger PDF</button>

      <div style="margin-top:15px">
        <table class="table-compact">
          <thead><tr><th colspan="2">RÃ©sumÃ©</th></tr></thead>
          <tbody>
            <tr><td>ImpÃ´t sur le revenu</td><td id="impot-total">â€”</td></tr>
            <tr><td>Revenu net</td><td id="revenu-net">â€”</td></tr>
          </tbody>
        </table>
        <table class="table-compact" style="margin-top:10px">
          <thead><tr><th colspan="2">Taux d'imposition</th></tr></thead>
          <tbody>
            <tr><td>Taux moyen</td><td id="taux-moyen">â€”</td></tr>
            <tr><td>Taux marginal</td><td id="taux-marginal">â€”</td></tr>
            <tr><td>Dividendes dÃ©terminÃ©s</td><td id="taux-div-det">â€”</td></tr>
            <tr><td>Gains en capital</td><td id="taux-gc">â€”</td></tr>
          </tbody>
        </table>
      </div>
    </div>

    <!-- Tableau paliers combinÃ©s -->
    <div class="card flex-item" style="flex:0.5;">
      <h3>ðŸ“Š Paliers combinÃ©s (Revenu imposable)</h3>
      <table class="table-compact" id="table-paliers-combine">
        <thead>
          <tr><th>Revenu imposable ($)</th>
          <th>FÃ©dÃ©ral</th>
          <th>Provincial</th>
          <th>Total</th>
        </tr>
        </thead>
        <tbody>
          <!-- JS va remplir ici -->
        </tbody>
      </table>
    </div>

  </div>

  <script src="js/script.js"></script>
  <script>
    // Paliers fÃ©dÃ©raux et QuÃ©bec
    const paliersFed = [
      {min:0,max:16128.99,taux:0},
      {min:16129,max:57374.99,taux:0.1211},
      {min:57375,max:114749.99,taux:0.1712},
      {min:114750,max:177881.99,taux:0.2171},
      {min:177882,max:253413.99,taux:0.2422},
      {min:253414,max:Infinity,taux:0.2756}
    ];
    const paliersQc = [
      {min:0,max:18570.99,taux:0},
      {min:18571,max:53254.99,taux:0.14},
      {min:53255,max:106494.99,taux:0.19},
      {min:106495,max:129589.99,taux:0.24},
      {min:129590,max:Infinity,taux:0.2575}
    ];

    // GÃ©nÃ©ration du tableau combinÃ©
    function remplirTableauPaliers() {
      const tableau = document.getElementById('table-paliers-combine').querySelector('tbody');
      let valeurs = [0];

      [...paliersFed, ...paliersQc].forEach(p => {
        const minArrondi = Math.round(p.min);
        if (!valeurs.includes(minArrondi) && minArrondi % 10 === 0) {
          valeurs.push(minArrondi);
        }
      });

      valeurs.sort((a,b)=>a-b);

      tableau.innerHTML = '';
      valeurs.forEach(v => {
        const tr = document.createElement('tr');
        const td = document.createElement('td');
        td.textContent = v.toLocaleString();
        tr.appendChild(td);
        tableau.appendChild(tr);
      });
    }

    remplirTableauPaliers();
  </script>



<script>

function telechargerPDF(){
  const { jsPDF } = window.jspdf;
  const doc = new jsPDF();
  const nom = document.getElementById('nom').value || "â€”";
  const revenu = document.getElementById('revenu').value || "â€”";

  const data = [
    ["ImpÃ´t sur le revenu", document.getElementById('impot-total').textContent],
    ["Revenu net", document.getElementById('revenu-net').textContent],
    ["Taux moyen", document.getElementById('taux-moyen').textContent],
    ["Taux marginal", document.getElementById('taux-marginal').textContent],
    ["Dividendes dÃ©terminÃ©s", document.getElementById('taux-div-det').textContent],
    ["Gains en capital", document.getElementById('taux-gc').textContent]
  ];

  doc.setFontSize(16);
  doc.text("Rapport de calcul d'impÃ´t", 14, 15);
  doc.setFontSize(11);
  doc.text("Date : " + new Date().toLocaleDateString(), 14, 22);
  doc.text("Client : " + nom, 14, 28);
  doc.text("Revenu imposable : " + revenu + " $", 14, 34);

  doc.autoTable({
    startY: 40,
    head: [["DÃ©tail", "Valeur"]],
    body: data,
    styles: { fontSize: 11 },
    headStyles: { fillColor: [11,92,255], textColor: 255 }
  });

  doc.setFontSize(10);
  doc.text("Signature : Clement Markus", 14, doc.lastAutoTable.finalY + 15);
  doc.save("rapport_impot.pdf");
}

calculerImpots();

</script>
<script src="js/script.js"></script>
</body>
</html>
